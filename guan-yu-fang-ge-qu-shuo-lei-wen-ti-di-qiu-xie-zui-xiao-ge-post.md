# 关于方格取数类问题的求解（最小割）

拿 P2774 举例。

因为题目说相邻的不能同时选，那么方格可以分成两类

![](https://cdn.luogu.com.cn/upload/image_hosting/nr4d0u0q.png)

一个点 $(x,y)$，$x+y$ 是偶数则为红色， 否则为白色。

考虑弄到图上。

- 源点 $S$ 向所有红色格子连边权为格子的价值的边

- 所有白色格子向汇点 $T$ 连边权为格子的价值的边

- 每个格子向周围 $4$ 个格子连边权为 $\infty$ 的边

那么我们要做的就是将这个图割掉一些边，使得 $S$ 和 $T$ 不连通。

因为 $S$ 连接所有红色格子，$T$ 连接所有白色格子，那么 $S$ 和 $T$ 不连通就表示没有红色格子连着白色格子，刚好满足题目要求。

那么这个图的最小割就是不选的点的价值和。

感性理解，因为格子之间的边是 $\infty$ 的，那么被删掉的边就只能是连源点或汇点的。

- $S$ 到一个红点的边被割了，表示这个红点不选，反之则选

- 一个白点到 $T$ 的边被割了，表示这个白点不选，反之则选

所以最小割就会选择最小的代价使得 $S$ 和 $T$ 不连通，答案就是所有格子的价值和减去最小割的值。

注意格子之间要双向边。