# 最大权闭合子图（最小割）解题思路及感性证明

[好文章](https://blog.csdn.net/can919/article/details/77603353)

闭合子图，满足子图中的点的**入度**等于原图中对应的点。说白了，要选一个东西，必须把其依赖的东西全部先选上。

常见应用是有一类物品，有代价选择，但把指定的一组物品全选了会产生收益。

考虑用配合网络流的最小割 $=$ 最大流解决，把问题放在二分图上，连边如下：

- **源点**（$S$）往 **有代价物品**（$A$）连边权为其代价的边。

- **有代价物品**（$A$）往 **选了它可能产生收益的组**（$B$）连边权为 $\infty$ 的边。

- **每个组**（$B$）往 **汇点**（$T$）连边权为其收益的边。

先把全部收益加在一起，最后减去最大流（最小割），即为答案。

**只有可能割掉与 $S$ 或 $T$ 连接的边**。

- 割掉 $S$ 与 $A$ 的边，表示不选择 $A$ ；

- 割掉 $B$ 与 $T$ 的边，表示选择 $B$ 。

感性理解，如果某个组在代价处就已经割断了，通过最小割，我们增加了代价，但保住了收益，如果割掉收益，说明这个组的收益不优，宁愿不要它，于是抵消了收益，但没有代价。